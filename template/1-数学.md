# 1-数学

----

## 素数检验

-  int 范围内：2, 7, 61
- long long 范围：2, 325, 9375, 28178, 450775, 9780504, 1795265022
- 3E15：2, 2570940, 880937, 610386380, 4130785767
- 4E13：2, 2570940, 211991001, 3749873356

````c++
//已检验int范围没有问题

bool checkQ(ll a, ll n) {
    if (n==2 || a>=n) return 1;
    if (n==1 || !(n&1)) return 0;
    ll d = n-1;
    while ( !(d&1)) d>>=1;
    ll t = pow_mod(a,d,n);
    while (d != n-1 && t != 1 && t != n-1) {
        t = t*t%n;
        d<<=1;
    }
    return t == n-1 || d&1;
}

bool primeQ(ll n) {
    static vector<ll> t = {2, 7, 61};
    if (n <= 1) return false;
    for (auto k: t) if (!checkQ(k, n)) return false;
    return true;
}
````



## NTT & FFT & FWT

### NTT

### FFT

```c++

const double PI = acos(-1);
struct C{
    double r, i;
    C(double r = 0, double i = 0): r(r), i(i){}
};
C operator + (const C&a, const C&b){
    return C(a.r+b.r, a.i+b.i);
}
C operator - (const C&a, const C&b){
    return C(a.r-b.r, a.i-b.i);
}
C operator * (const C&a, const C&b){
    return C(a.r*b.r-a.i*b.i, a.r*b.i + a.i*b.r);
}
void FFT(C x[], int n, int p) {
    for (int i = 0, t = 0; i < n; ++i) {
        if (i > t) swap(x[i], x[t]);
        for (int j = n >> 1; (t ^= j) < j; j >>= 1);
    }
    for (int h = 2; h <= n; h <<= 1) {
        C wn(cos(p * 2 * PI / h), sin(p * 2 * PI / h));
        for (int i = 0; i < n; i += h) {
            C w(1, 0), u;
            for (int j = i, k = h >> 1; j < i + k; ++j) {
                u = x[j + k] * w;
                x[j + k] = x[j] - u;
                x[j] = x[j] + u;
                w = w * wn;
            }
        }
    }
    if (p == -1){
        for(int i = 0; i<=n; i++) x[i].r /= n;
    }
}

void conv(C a[], C b[], int n) {
    FFT(a, n, 1);
    FFT(b, n, 1);
    for(int i = 0; i<=n; i++){
        a[i] = a[i] * b[i];
    }
    FFT(a, n, -1);
}
```

### FWT